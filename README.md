# AlgoW - Algorand Wallet API
<div id="top"></div>

<!-- ABOUT THE PROJECT -->
## About The Project

![overview][overview]

This is an API that **generates accounts** and **sends transactions on Algorand Blockchain**.

It can be used to generate an Algo Address and transactions locally and send these transactions to Algorand Network.

Since the project focused on generating addresses and transactions locally and broadcasting them, there is no user interface layer implementation.

Here is a short description of API methods:

* 1- generateAlgoAddress (GET): This is an offline method that uses the local AlgoSDK library to generate an account. With this account, we can reach information such as Secret Key, Mnemonic, Address, etc.
* 2- regenerateAlgoAddressWithMnemonic (POST): Offline method to re-generate the account and so address with a given Mnemonic.
* 3- regenerateAlgoAddressWithSK (POST): ANother offline method to re-generate the account and so address with the given Secret Key.
* 4- createAlgoTrx (POST): This method gets the latest info from Algorand blockchain via AlgoClient which is generated by AlgoSDK to connect Algorand Network. 
(AlgoClient's parameters are the base server URL of PureStake API, API key which was taken from PureStake website, and the port number.) After getting the current info from the network, the transaction object is created and signed with the sender's Secret Key locally. Then this transaction is broadcast to the network again via AlgoClient.
* 5- getBalance (GET): This method directly reaches the network via AlgoClient and gets the balance of the given address.



<p align="right">(<a href="#top">back to top</a>)</p>



### Built With


* [Node.js](https://nodejs.org/)
* [algosdk](https://github.com/algorand/js-algorand-sdk)
* [expressjs](https://expressjs.com/)

<p align="right">(<a href="#top">back to top</a>)</p>



<!-- GETTING STARTED -->
## Keys And Addresses
Algorand uses Ed25519 high-speed, high-security elliptic-curve signatures. The keys are produced through standard, open-source cryptographic 
libraries packaged with each of the SDKs. The key generation algorithm takes a random value as input and outputs two 32-byte arrays, representing 
a public key and its associated private key. These are also referred to as a public/private key pair. These keys perform important cryptographic 
functions like signing data and verifying signatures.
![keys1][keys1]


The public key is transformed into an Algorand address, by adding a 4-byte checksum to the end of the public key and then encoding it in base32. 
The result is what both the developer and end-user recognize as an Algorand address. The address is 58 characters long.
![keys2][keys2]

The 25-word mnemonic is the most user-friendly representation of the private key. This representation is called the private key mnemonic. 
You may also see it referred to as a passphrase.
![keys3][keys3]

(source: developer.algorand.org)

## Transaction Structure
Here is a basic transaction JSON object is. 

```
    let txn = {
        "from": <Sender Address(String)>,
        "to": <Receiver Address(String)>,
        "amount": <Amount To Send In MicroAlgos(UnsignedInteger)>,
        "fee": <Transaction Fee In MicroAlgos(UnsignedInteger)>,
        "firstRound": <First Valid Round(UnsignedInteger)>,
        "lastRound": <Last Valid Round(UnsignedInteger)>,
        "genesisID": <Id Of Genesis(UnsignedInteger)>,
        "genesisHash": <Hash Of Genesis(String)>,
        "note": <An Arbitrary Note(Uint8Array)>,
    };  
```

## Prerequisites

### NodeJS
In order to run this API, NodeJS should be installed in the running environment. Please follow these steps:
* Download the installer from NodeJS WebSite.
* Run the installer.
* Follow the installer steps, agree on the license agreement, and click the next button.
* Restart your system/machine.

Now, test NodeJS by printing its version using the following command in Command Prompt:
  ```sh
  node -v
  ```
  
  ```sh
  npm -v
  ```

#### Clone
Clone the repository, open a terminal and route to the project folder, and run this command in the project folder in order to install.

  ```sh
  npm install
  ```

### Purestake API Access Key

In this step, we use Purestack API as a proxy to broadcast the locally created transactions to the Algorand Network.

Purestake Algorand access credentials can be obtain on https://developer.purestake.io/

### Postman

Sending requests is another important step to test our API properly. Although there are several software options such as Swagger UI, Insomnia REST Client, Paw, cURL, etc. I used postman in this step.

## Usage 

The project runs as follows step-by-step:

* Once the project is cloned and installed, this command should be run in the project location in terminal

  ```sh
  node app.js
  ```
  
  ![usage1][usage1]
  
* Open postman and send get request to create our first account.

  ![usage2][usage2]
  
* We need to copy the freshly generated account's mnemonic and paste it to the .env file. Please notice that the ``.env`` file and mnemonics should always be hidden in the local development environment and not be posted on Github. It's shared only for this project. In the ``.env`` file, there are also Purestake credentials. So after this step, it should look like below:

  ```sh
  BASE_SERVER=https://testnet-algorand.api.purestake.io/ps2
  API_KEY=PIEhp7eaqk7MNDi9mEvQ592JUgU3J4Lb91wVNiUi
  SENDER_MNEMONIC=glad gap element donate sunny lab disease brain rotate alone delay valve salute giant dash dentist high coconut make cute hedgehog wall palm able letter
  ```
  
* After generating the account, we must fund the account in order to create a transaction. All transactions need funds at least to pay the transaction fee. Since we connect our Purestake API to the testnet, Algorand Testnet Faucet will work for us. (https://bank.testnet.algorand.network/)

  ![usage3][usage3]
  
  We can track the transaction details on Algorand Testnet Explorer (https://testnet.algoexplorer.io/)
  
  ![usage4][usage4]

  
* At this step, we need another account to create a transaction and send the funds from the first account.

  ![usage5][usage5]

  Now we have two freshly generated accounts one with funds. The next step is creating a transaction and transferring funds between accounts.
 
* On postman, we can simply create a POST request with the JSON String below.

  ```
  {
    "receiverAddress": "SW4V73S73WD7B7YV6DEMWROIEKTTJ5BHAKFD7GG45KL7LE672YT6AAULHE",
    "amount": 9000000
  }
  ```
  
  Please note that the amount should be number and in microAlgos.

  ![usage6][usage6]
  
 * After we send the request, our API creates the transaction, signs it by using the first account's Secret Key which is generated from Mnemonic we paste into the ``.env`` file before. And returns the Transaction ID as the response.

  Now we can check our transaction on Algorand Testnet Explorer.
  
  ![usage7][usage7]
  
<!-- LIMITATIONS -->
## Limitations And Future Work
  Since this project focuses on generating addresses and transactions in a happy path, some steps were skipped such as input validation and exception handling. 
  
  Also in the project, Purestake API is used as a gateway to the Algorand TestNet. There are request count and usage limitations on purestake itself. Another method is to use our own node to broadcast transactions and it needs more technical requirements and development.
  
  There are 2 more methods implemented but not mentioned in this document; ``regenerateAlgoAddressWithSK`` which regenerates an Algorand Account with a given Secret Key and ``regenerateAlgoAddressWithMnemonic`` which regenerates the account with a given Mnemonic. **Overall with these features, this application can be assumed as an Algorand Wallet**.
  
  Another important note is on account generation. Public blockchain transactions like Algorand are very transparent. This makes accounts vulnerable to hacking. Algorand uses random numbers to generate accounts with respect to the cryptography algorithm it uses. Programmed libraries are usually not good at generating real random numbers. So it's always better to generate accounts with real random numbers with special random number generator machines or natural actions such as user's mouse moves.

<!-- CONTACT -->
## Contact

Salih Cemil Cetin - [@salihcemil](https://twitter.com/salihcemil) - salihcemil@gmail.com

Project Link: [https://github.com/salihcemil/AlgoW](https://github.com/salihcemil/AlgoW)

<p align="right">(<a href="#top">back to top</a>)</p>



<!-- MARKDOWN LINKS & IMAGES -->
<!-- https://www.markdownguide.org/basic-syntax/#reference-style-links -->
[overview]: Images/Overview.drawio.png
[keys1]: Images/algoAccounts.png
[keys2]: Images/accounts-1.png
[keys3]: Images/accounts-3.png
[usage1]: Images/usage1.png
[usage2]: Images/usage2.png
[usage3]: Images/usage3.png
[usage4]: Images/usage4.png
[usage5]: Images/usage5.png
[usage6]: Images/usage6.png
[usage7]: Images/usage7.png
